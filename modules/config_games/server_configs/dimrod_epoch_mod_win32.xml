<game_config>
  <game_key>Dimrod_epochmod_win32</game_key>
  <installer>steamcmd</installer>
  <game_name>Dimrod Epoch Mod</game_name>
  <server_exec_name>arma2oaserver.exe</server_exec_name>
  <cli_template>%MODLIST% -cfg=cfg\basic.cfg -config=cfg\server.cfg -name=dayz -profiles=cfg %IP% %PORT% %PID_FILE%</cli_template>
  <cli_params>
    <cli_param id="PORT" cli_string="-port=" />
    <cli_param id="IP" cli_string="-ip=" />
    <cli_param id="PID_FILE" cli_string="-pid=" />
  </cli_params>
  <reserve_ports>
    <port type="add" id="QUERY_PORT">1</port>
  </reserve_ports>
  <cli_allow_chars>;</cli_allow_chars>
  <console_log>cfg/arma2oaserver.RPT</console_log>
  <max_user_amount>64</max_user_amount>
  <control_protocol>armabe</control_protocol>
  <mods>
    <mod>
      <name>none</name>
      <installer_name>33930</installer_name>
    </mod>
  </mods>
  <replace_texts>
    <text key="max_players">
      <default>(maxPlayers\s*=\s*)(.*)(;)</default>
      <var>maxPlayers = "%key%";</var>
      <filepath>cfg/server.cfg</filepath>
      <options>key-regex</options>
    </text>
    <text key="PORT">
      <default>port =.*</default>
      <var>set "port=%key%" </var>
      <filepath>restart/temp.bat</filepath>
      <options>key-regex</options>
    </text>
    <text key="IP">
      <default>ip =.*</default>
      <var>set "ip=%key%" </var>
      <filepath>restart/temp.bat</filepath>
      <options>key-regex</options>
    </text>
    <text key="CONTROL_PASSWORD">
      <default>pswd =.*</default>
      <var>set "pswd=%key%" </var>
      <filepath>restart/temp.bat</filepath>
      <options>key-regex</options>
    </text>
    <text key="PID_FILE">
      <default>pid =.*</default>
      <var>set "pid=%key%" </var>
      <filepath>restart/temp.bat</filepath>
      <options>key-regex</options>
    </text>

    <text key="home_path">
      <default>BePath =.*</default>
      <var>BePath = %key%/cfg/Battleye</var>
      <filepath>bec/config/config.cfg</filepath>
      <options>key-regex</options>
    </text>
  </replace_texts>
  <server_params>
    <param id="MODLIST" key="-mod=" type="text">
      <default>@dayz_epoch;@epochserver;</default>
      <option>ns</option>
      <caption>Mods ex: @dayz;@hive or @dayz_epoch;@dayz_epoch_server</caption>
      <desc>Semicolon after each mod and you MUST copy the KEY into your keys folder. 
            Make sure if you install a MOD, you list the name here or else it wont get loaded.
      </desc>
    </param>
  </server_params>

  <pre_install>
#    wget http://files.iaregamer.com/installers/arma2oa_win32/arma2oa_win32.tar .
#    tar -xvf arma2oa_win32.tar
#    rm arma2oa_win32.tar
#    wget http://files.iaregamer.com/installers/arma2/arma2Addons.tar .
#    tar -xvf arma2Addons.tar
#    rm arma2Addons.tar
#    wget http://files.iaregamer.com/installers/dimrod_epoch_mod/dimrod_epoch_mod.tar .
#    tar -xvf dimrod_epoch_mod.tar
#    rm epoch_mod.tar
  </pre_install>

  <post_install>
#    mkdir -p ./cfg
#    touch ./cfg/dimrod_dayz_mod_win32.xml
    #chmod +x setup_db.sh
    #./setup_db.sh
    #rm setup_db.sh
  </post_install>

  <pre_start>
    cd restart
    echo set "ip=%IP%" > setvars.bat
    echo set "port=%PORT%" >> setvars.bat
    echo set "pswd=%CONTROL_PASSWORD%"
    echo set "pid=%PID% >> setvars.bat
    echo start restart.bat >> setvars.bat
  </pre_start>

  <lock_files>
    Arma2Server.exe
    Arma2Server_x64.exe
  </lock_files>

  <configuration_files>
    <file description="Server settings">cfg\server.cfg</file>
    <file description="Basic Network settings" >cfg\basic.cfg</file>
    <file description="BattlEye Rcon Password" >cfg\battleye\beserver.cfg</file>
    <file description="DB settings and Date/Time">cfg\hiveext.ini</file>
    <file description="Difficulty Settings">cfg\users\dayz\dayz.arma2oaprofile</file>
  </configuration_files>
</game_config>
